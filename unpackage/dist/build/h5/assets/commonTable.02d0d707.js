import{d as e,o as l,c as a,a as t,_ as o,bt as i,g as n,f as d,w as c,x as r,t as s,u,b as p,e as m,i as v,y as f,n as h,m as g,p as b}from"./index.8b0944bc.js";import{S as k,b as w,E as _,a as V}from"./el-table-column.df8e3a4c.js";import{E as y}from"./el-checkbox.d18bdc0c.js";import{d as x}from"./formatter.bb2910d3.js";const A={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 576 512"},C=[t("path",{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z",fill:"currentColor"},null,-1)];var S=e({name:"Edit",render:function(e,t){return l(),a("svg",A,C)}});var $=o({__name:"commonTable",props:{title:String,data:String,getApi:String,addApi:String,delApi:String},setup(e){const o=e,A=i(),C=n(!1),$=n(""),z=n(""),U=n("");let j=!1;const B=()=>{if(j)return;j=!0,C.value=!1;let e={name:$.value,_id:z.value};U.value&&(e.link=U.value),v(o.addApi,e).then((e=>{A[o.getApi](),$.value="",z.value="",U.value="",f.success("保存成功"),j=!1})).catch((()=>{j=!1}))};let E=[];const T=e=>{E=e},H=()=>{let e=E.length;if(e>0){let l=E.map((e=>e._id));w.confirm(`确定要删除这 ${e} 项吗？`,"彻底删除！！！",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((()=>{j||(j=!0,v(o.delApi,{ids:l}).then((e=>{A[o.getApi](),f.success("删除成功"),j=!1})).catch((()=>{j=!1})))})).catch((()=>{}))}},L=()=>{C.value=!0,$.value="",z.value="",U.value=""};return(e,i)=>{const n=h,w=_,E=y,M=V,I=g,q=b;return l(),a("div",{class:"container"},[t("div",{class:"tools"},[d(n,{onClick:H,type:"danger"},{default:c((()=>[r("删除选中")])),_:1}),d(n,{onClick:L,type:"primary"},{default:c((()=>[r(s(`新增${o.title}`),1)])),_:1}),d(n,{onClick:u(A)[o.getApi],icon:u(k),circle:"",style:{float:"right"}},null,8,["onClick","icon"])]),d(M,{data:u(A)[o.data],onSelectionChange:T,style:{width:"100%"}},{default:c((()=>[d(w,{type:"selection",width:"55"}),d(w,{prop:"name",label:`${o.title}名称`},null,8,["label"]),"友链"==o.title?(l(),p(w,{key:0,prop:"link",label:"链接地址"})):m("",!0),"友链"==o.title?(l(),p(w,{key:1,label:"前台展示"},{default:c((e=>[d(E,{onChange:l=>(e=>{if(j)return;j=!0;let l={_id:e._id,name:e.name,link:e.link,isApproved:e.isApproved};v(o.addApi,l).then((e=>{f.success("修改成功"),j=!1})).catch((()=>{j=!1}))})(e.row),modelValue:e.row.isApproved,"onUpdate:modelValue":l=>e.row.isApproved=l,size:"small"},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1})):m("",!0),d(w,{prop:"created_date",label:"更新日期",formatter:u(x)},null,8,["formatter"]),d(w,{label:"操作",fixed:"right",width:80},{default:c((e=>[d(n,{onClick:l=>{return a=e.row,C.value=!0,$.value=a.name,z.value=a._id,void(U.value=a.link);var a},circle:"",icon:u(S),size:"small",type:"warning"},null,8,["onClick","icon"])])),_:1})])),_:1},8,["data"]),d(q,{modelValue:C.value,"onUpdate:modelValue":i[3]||(i[3]=e=>C.value=e),width:"400px",title:`编辑${o.title}`},{footer:c((()=>[d(n,{onClick:i[2]||(i[2]=e=>C.value=!1)},{default:c((()=>[r("取消")])),_:1}),d(n,{type:"primary",disabled:!$.value,onClick:B},{default:c((()=>[r("保存")])),_:1},8,["disabled"])])),default:c((()=>[d(I,{modelValue:$.value,"onUpdate:modelValue":i[0]||(i[0]=e=>$.value=e),placeholder:`在这里输入${o.title}名称`},null,8,["modelValue","placeholder"]),"友链"==o.title?(l(),p(I,{key:0,style:{"margin-top":"20px"},modelValue:U.value,"onUpdate:modelValue":i[1]||(i[1]=e=>U.value=e),placeholder:`在这里输入${o.title}链接`},null,8,["modelValue","placeholder"])):m("",!0)])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-8cf2ef6c"]]);export{$ as c};

import{_ as e,h as a,bt as s,g as l,a7 as u,i as n,m as r,n as o,o as d,c as t,f as m,w as i,a as p,t as v,u as c,x as _,bu as f,r as h,y as g}from"./index.8b0944bc.js";import{E as w}from"./el-card.d1343cac.js";var b=e({__name:"login",setup(e){let b="";a((e=>{b=e.from}));const x=s(),V=l(!0),k=l({username:"",password:""}),y=l(!1),I=u((()=>!k.value.username||!k.value.password));n("getUserName").then((e=>{e.username?k.value.username=e.username:y.value=!0,V.value=!1}));const U=async()=>{V.value||(V.value=!0,await j())},j=()=>{n(y.value?"register":"login",k.value).then((e=>{x.userInfo={username:e.username},f("userInfo",x.userInfo),f("uni_id_token",e.token),f("uni_id_token_expired",e.tokenExpired),h.reLaunch(b||"admin/index").then((()=>{g.success("登录成功")}))})).catch((e=>{V.value=!1}))};return(e,a)=>{const s=r,l=o,u=w;return d(),t("div",{class:"login-wrap"},[m(u,null,{header:i((()=>[p("span",null,v(y.value?"注册并自动登录":"系统登录"),1)])),default:i((()=>[m(s,{modelValue:k.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>k.value.username=e),placeholder:"账号"},null,8,["modelValue"]),m(s,{modelValue:k.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>k.value.password=e),type:"password",placeholder:"密码"},null,8,["modelValue"]),m(l,{type:"primary",loading:V.value,disabled:c(I),onClick:U},{default:i((()=>[_(v(y.value?"注册":"登录"),1)])),_:1},8,["loading","disabled"])])),_:1})])}}},[["__scopeId","data-v-54025964"]]);export{b as default};
